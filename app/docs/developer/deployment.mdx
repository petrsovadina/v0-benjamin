# ğŸš€ Deployment Guide - Benjamin v0.3

Tento dokument popisuje postup nasazenÃ­ backendu (FastAPI) a frontendu (Next.js) aplikace Benjamin.

## ğŸ“‹ Prerekvizity

- **Docker** & **Docker Compose** (pro kontejnerizovanÃ© nasazenÃ­)
- **Node.js 18+** (pro frontend build)
- **Python 3.11+** (pro backend manual run)
- **Supabase Project** (databÃ¡ze a auth)

## ğŸ› ï¸ Konfigurace prostÅ™edÃ­

PÅ™ed spuÅ¡tÄ›nÃ­m je nutnÃ© nastavit promÄ›nnÃ© prostÅ™edÃ­. PouÅ¾ijte `.env.example` jako Å¡ablonu.

### Backend (`backend/.env`)
```bash
ANTHROPIC_API_KEY=sk-ant-...
SUPABASE_URL=https://xyz.supabase.co
SUPABASE_SERVICE_KEY=...
# ... dalÅ¡Ã­ promÄ›nnÃ© z backend/.env.example
```

### Frontend (`.env.local` nebo `.env.production`)
```bash
NEXT_PUBLIC_SUPABASE_URL=https://xyz.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=...
NEXT_PUBLIC_API_URL=https://api.benjamin.cz # URL vaÅ¡eho nasazenÃ©ho backendu
```

---

## ğŸ³ NasazenÃ­ Backendu (Docker)

Backend je pÅ™ipraven pro nasazenÃ­ v Docker kontejneru.
**DÅ®LEÅ½ITÃ‰:** VÅ¡echny pÅ™Ã­kazy spouÅ¡tÄ›jte z **koÅ™enovÃ©ho adresÃ¡Å™e** projektu.

### 1. Build Image
```bash
# Specifikujeme Dockerfile v backend sloÅ¾ce, ale kontext je root
docker build -t benjamin-backend:v0.3 -f backend/Dockerfile .
```

### 2. SpuÅ¡tÄ›nÃ­ Kontejneru
```bash
docker run -d \
  -p 8000:8000 \
  --env-file backend/.env \
  --name benjamin-api \
  benjamin-backend:v0.3
```

Aplikace pobÄ›Å¾Ã­ na `http://localhost:8000`.
Health check: `GET http://localhost:8000/health`

---

## ğŸ–¥ï¸ ManuÃ¡lnÃ­ SpuÅ¡tÄ›nÃ­ (LokÃ¡lnÃ­ VÃ½voj)

Pro lokÃ¡lnÃ­ vÃ½voj bez Dockeru:

### 1. Python prostÅ™edÃ­
```bash
# VytvoÅ™enÃ­ venv
python -m venv backend/venv

# Aktivace
source backend/venv/bin/activate  # macOS/Linux

# Instalace zÃ¡vislostÃ­
pip install -r backend/requirements.txt
```

### 2. SpuÅ¡tÄ›nÃ­ Serveru
```bash
# SpouÅ¡tÄ›jte z koÅ™enovÃ©ho adresÃ¡Å™e projektu!
uvicorn backend.main:app --reload --port 8000
```

---

## ğŸŒ NasazenÃ­ Frontendu (Vercel/Netlify)

Frontend je standardnÃ­ Next.js aplikace.

### Vercel (DoporuÄeno)
1. Propojte GitHub repository s Vercelem.
2. V nastavenÃ­ projektu pÅ™idejte Environment Variables z `.env.production`.
3. Deploy probÄ›hne automaticky.
    - **Build Command:** `next build` (nebo `pnpm build`)
    - **Install Command:** `pnpm install`

---

## ğŸ“ PoznÃ¡mky k Produkci
- **DatabÃ¡ze:** UjistÄ›te se, Å¾e jste aplikovali vÅ¡echny SQL migrace (`supabase/migrations`).
- **Rate Limiting:** V produkci (napÅ™. za Nginx/Traefik) mÅ¯Å¾e bÃ½t nutnÃ© nastavit `slowapi` na pouÅ¾itÃ­ `X-Forwarded-For` hlaviÄky pro sprÃ¡vnou detekci IP adresy.
