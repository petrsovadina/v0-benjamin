============================= test session starts ==============================
platform darwin -- Python 3.13.9, pytest-9.0.2, pluggy-1.6.0 -- /Users/petrsovadina/Desktop/Develope/benjamin/v0-benjamin/backend/venv/bin/python3.13
cachedir: .pytest_cache
rootdir: /Users/petrsovadina/Desktop/Develope/benjamin/v0-benjamin
plugins: anyio-4.12.0, langsmith-0.5.0, asyncio-1.3.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 4 items

backend/tests/test_api_integration.py::test_health_check PASSED          [ 25%]
backend/tests/test_api_integration.py::test_query_endpoint_structure FAILED [ 50%]
backend/tests/test_api_integration.py::test_query_endpoint_success PASSED [ 75%]
backend/tests/test_api_integration.py::test_rate_limit_headers PASSED    [100%]

=================================== FAILURES ===================================
________________________ test_query_endpoint_structure _________________________

    def test_query_endpoint_structure():
        """Ověří strukturu s mockovaným uživatelem."""
        app.dependency_overrides[get_current_user] = lambda: {"id": "test_user"}
        # Test validace vstupu (chybějící message/query)
        response = client.post("/api/v1/query", json={})
        app.dependency_overrides = {}
    
        # 422 Unprocessable Entity expected
>       assert response.status_code == 422
E       assert 500 == 422
E        +  where 500 = <Response [500 Internal Server Error]>.status_code

backend/tests/test_api_integration.py:26: AssertionError
=============================== warnings summary ===============================
backend/app/schemas/query.py:12
  /Users/petrsovadina/Desktop/Develope/benjamin/v0-benjamin/backend/app/schemas/query.py:12: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    @validator("query", pre=True, always=True)

backend/app/schemas/query.py:4
  /Users/petrsovadina/Desktop/Develope/benjamin/v0-benjamin/backend/app/schemas/query.py:4: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class QueryRequest(BaseModel):

backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:365
  /Users/petrsovadina/Desktop/Develope/benjamin/v0-benjamin/backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:365: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    @model_validator(mode="after")

backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:494
  /Users/petrsovadina/Desktop/Develope/benjamin/v0-benjamin/backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:494: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    @model_validator(mode="after")

backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:498
  /Users/petrsovadina/Desktop/Develope/benjamin/v0-benjamin/backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:498: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    @model_validator(mode="after")

backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:502
  /Users/petrsovadina/Desktop/Develope/benjamin/v0-benjamin/backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:502: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    @model_validator(mode="after")

backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:506
  /Users/petrsovadina/Desktop/Develope/benjamin/v0-benjamin/backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:506: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    @model_validator(mode="after")

backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:538
  /Users/petrsovadina/Desktop/Develope/benjamin/v0-benjamin/backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:538: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    @model_validator(mode="after")

backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:542
  /Users/petrsovadina/Desktop/Develope/benjamin/v0-benjamin/backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:542: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    @model_validator(mode="after")

backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:546
  /Users/petrsovadina/Desktop/Develope/benjamin/v0-benjamin/backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:546: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    @model_validator(mode="after")

backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:550
  /Users/petrsovadina/Desktop/Develope/benjamin/v0-benjamin/backend/venv/lib/python3.13/site-packages/pyiceberg/table/metadata.py:550: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    @model_validator(mode="after")

backend/data_processing/config/settings.py:4
  /Users/petrsovadina/Desktop/Develope/benjamin/v0-benjamin/backend/data_processing/config/settings.py:4: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class Settings(BaseSettings):

backend/tests/test_api_integration.py::test_query_endpoint_structure
  /Users/petrsovadina/Desktop/Develope/benjamin/v0-benjamin/backend/venv/lib/python3.13/site-packages/supabase/_sync/client.py:309: DeprecationWarning: The 'timeout' parameter is deprecated. Please configure it in the http client instead.
    return SyncPostgrestClient(

backend/tests/test_api_integration.py::test_query_endpoint_structure
  /Users/petrsovadina/Desktop/Develope/benjamin/v0-benjamin/backend/venv/lib/python3.13/site-packages/supabase/_sync/client.py:309: DeprecationWarning: The 'verify' parameter is deprecated. Please configure it in the http client instead.
    return SyncPostgrestClient(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED backend/tests/test_api_integration.py::test_query_endpoint_structure
=================== 1 failed, 3 passed, 14 warnings in 1.63s ===================
