{
  "file_path": "backend/data_processing/parsers/sukl_document_parser.py",
  "main_branch_history": [],
  "task_views": {
    "001-complete-guidelines-rag-pdf-import": {
      "task_id": "001-complete-guidelines-rag-pdf-import",
      "branch_point": {
        "commit_hash": "d092d181e511c0ef7a36dcfd2dfe3f083cbae73e",
        "content": "",
        "timestamp": "2025-12-25T01:35:52.079046"
      },
      "worktree_state": {
        "content": "import csv\nimport logging\nfrom pathlib import Path\nfrom typing import List, Dict, Any\n\nlogger = logging.getLogger(__name__)\n\nclass SuklDocumentParser:\n    \"\"\"\n    Parses 'dlp_nazvydokumentu.csv' to map SUKL codes to SPC/PIL filenames.\n    \"\"\"\n\n    def parse_mapping(self, file_path: Path) -> List[Dict[str, Any]]:\n        results = []\n        try:\n            # S\u00daKL CSVs in this set are usually cp1250 encoded\n            encoding = 'cp1250'\n            \n            with open(file_path, mode='r', encoding=encoding, errors='replace') as f:\n                # Detect delimiter\n                content_snippet = f.read(1024)\n                f.seek(0)\n                delimiter = ';' if ';' in content_snippet else ','\n                \n                reader = csv.DictReader(f, delimiter=delimiter)\n                \n                for row in reader:\n                    clean_row = {k.strip(): v.strip() for k, v in row.items() if k}\n                    \n                    sukl_code = clean_row.get(\"KOD_SUKL\", \"\")\n                    if not sukl_code:\n                        continue\n                        \n                    sukl_code = sukl_code.zfill(7)\n                    \n                    spc = clean_row.get(\"SPC\", \"\")\n                    pil = clean_row.get(\"PIL\", \"\")\n                    \n                    # Some validity check?\n                    if not spc and not pil:\n                        continue\n                        \n                    results.append({\n                        \"sukl_code\": sukl_code,\n                        \"spc_file\": spc if spc else None,\n                        \"pil_file\": pil if pil else None\n                    })\n                    \n        except Exception as e:\n            logger.error(f\"Failed to parse Document Mapping file {file_path}: {e}\")\n            raise\n            \n        return results\n",
        "last_modified": "2025-12-25T21:22:14.925559"
      },
      "task_intent": {
        "title": "001-complete-guidelines-rag-pdf-import",
        "description": "",
        "from_plan": false
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2025-12-25T01:36:13.464249",
  "last_updated": "2025-12-25T01:36:13.479063"
}