{
  "complexity": "complex",
  "workflow_type": "feature",
  "confidence": 0.88,
  "reasoning": "Comprehensive testing ('komplexní testování') requires building entire frontend testing infrastructure from scratch (~68 files with no tests), enhancing existing backend tests (10 files), and potentially adding E2E testing. This involves multiple services, new dependencies, CI/CD changes, and architectural decisions for test patterns in a newer tech stack (Next.js 16 + React 19).",

  "analysis": {
    "scope": {
      "estimated_files": 30,
      "estimated_services": 2,
      "is_cross_cutting": true,
      "notes": "Frontend: ~68 source files need tests (42 components, 20 pages, 6 lib). Backend: 10 existing test files may need enhancement. New config files, CI changes, and test utilities required."
    },
    "integrations": {
      "external_services": ["Supabase", "Anthropic API", "OpenAI API"],
      "new_dependencies": ["vitest", "@testing-library/react", "@testing-library/jest-dom", "@testing-library/user-event", "jsdom", "playwright"],
      "research_needed": true,
      "notes": "Testing frameworks for Next.js 16 + React 19 is newer stack. Need research on proper SSR component testing, server actions testing, and modern testing patterns."
    },
    "infrastructure": {
      "docker_changes": false,
      "database_changes": false,
      "config_changes": true,
      "notes": "CI workflow needs frontend test job. New config files: vitest.config.ts, playwright.config.ts, test setup files. May need adjustments to package.json scripts."
    },
    "knowledge": {
      "patterns_exist": true,
      "research_required": true,
      "unfamiliar_tech": ["Next.js 16 testing patterns", "React 19 testing", "Vitest with App Router"],
      "notes": "Backend has good pytest patterns to follow. Frontend has no testing patterns - need to establish from scratch. Next.js 16 and React 19 are relatively new, requiring research for best practices."
    },
    "risk": {
      "level": "medium",
      "concerns": [
        "Testing React Server Components requires specific approach",
        "Mocking Supabase auth in tests needs careful setup",
        "Next.js App Router testing has different patterns than Pages Router",
        "Async server actions testing complexity",
        "CI execution time may increase significantly"
      ],
      "notes": "Main risk is complexity in properly testing SSR components and server actions. Need to ensure tests don't become flaky."
    }
  },

  "recommended_phases": [
    "discovery",
    "requirements",
    "research",
    "context",
    "spec_writing",
    "self_critique",
    "planning",
    "validation"
  ],

  "flags": {
    "needs_research": true,
    "needs_self_critique": true,
    "needs_infrastructure_setup": true
  },

  "validation_recommendations": {
    "risk_level": "medium",
    "skip_validation": false,
    "minimal_mode": false,
    "test_types_required": ["unit", "integration"],
    "security_scan_required": false,
    "staging_deployment_required": false,
    "reasoning": "This is a testing infrastructure task - validation focuses on ensuring tests run correctly in CI. Medium risk due to complexity of testing setup, but no security concerns since we're adding tests, not modifying business logic."
  },

  "codebase_analysis": {
    "frontend": {
      "framework": "Next.js 16",
      "language": "TypeScript",
      "components_count": 42,
      "pages_count": 20,
      "lib_files_count": 6,
      "existing_tests": 0,
      "test_dependencies": [],
      "testing_gap": "Complete - no frontend tests or testing infrastructure exists"
    },
    "backend": {
      "framework": "FastAPI",
      "language": "Python",
      "existing_tests": 10,
      "test_dependencies": ["pytest", "pytest-asyncio"],
      "testing_gap": "Partial - good patterns exist but coverage may need enhancement"
    },
    "ci": {
      "backend_tests": true,
      "frontend_tests": false,
      "e2e_tests": false
    }
  },

  "created_at": "2025-12-26T19:45:00Z"
}
